<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Education System - –£—á–∏—Ç–µ–ª—å</title>
    <link rel="stylesheet" href="/css/teacher-dashboard.css">
</head>
<body>
<div class="dashboard">
    <!-- Top Bar (Header) -->
    <div class="top-bar">
        <div class="brand-section">
            <div class="brand">
                <h1>üéì –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</h1>
                <p class="welcome-message" id="welcome-message">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p>
            </div>

            <!-- Wikipedia Search Widget -->
            <div class="wikipedia-widget">
                <div class="search-container">
                    <input type="text"
                           id="wikipediaSearch"
                           placeholder="–ù–∞–π—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª –≤ Wikipedia..."
                           class="wikipedia-search-input">
                    <div id="wikipediaResults" class="wikipedia-results"></div>
                </div>
            </div>
        </div>

        <!-- Top Actions -->
        <div class="top-actions">
            <!-- Gamification Button -->
            <a href="teacher-gamification.html" class="btn-action btn-nav">
                üéÆ –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è
            </a>
            <span id="notification-badge" style="display: none;"></span>
            <a href="/profile.html" class="btn-action btn-nav">
                üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
            </a>
            <a href="/chat.html" class="btn-action btn-nav">
                üí¨ –ß–∞—Ç
                <span id="chat-badge" class="nav-badge" style="display: none;"></span>
            </a>

            <!-- Logout Button -->
            <button class="btn-logout" onclick="logout()">
                <span class="logout-icon">üö™</span>
                –í—ã–π—Ç–∏
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Left Column -->
        <div class="left-column">
            <!-- Quick Actions Card -->
            <div class="card quick-actions">
                <div class="card-header">
                    <h2>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                </div>
                <button class="btn-action btn-primary" onclick="showCreateAssignmentModal()">
                    üìù –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                </button>
                <button class="btn-action btn-secondary" onclick="loadSubmissionsToGrade()">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
                </button>
                <div class="pending-count">
                    <span id="pending-count">0</span> –∑–∞–¥–∞–Ω–∏–π –∂–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
                </div>
            </div>

            <!-- My Schedule Card -->
            <div class="card clickable" onclick="location.href='/teacher-schedule.html'">
                <div class="card-icon">üìÖ</div>
                <div class="card-content">
                    <h3>–ú–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –º–æ–µ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É—Ä–æ–∫–æ–≤</p>
                </div>
                <div class="card-arrow">‚Üí</div>
            </div>

            <div class="card surveys-card">
                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
                    <h2>üó≥ –û–ø—Ä–æ—Å—ã</h2>
                    <span id="surveys-counter" class="badge-pill">‚Äî</span>
                </div>

                <div id="surveys-message" class="surveys-message">
                    –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ä–æ—Å—ã...
                </div>

                <button id="open-survey-btn" class="btn-primary" style="margin-top:0.5rem; display:none;">
                    –ü—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å
                </button>
            </div>

            <!-- My Classes Card -->
            <div class="card">
                <div class="card-header">
                    <h2>üè´ –ú–æ–∏ –∫–ª–∞—Å—Å—ã</h2>
                </div>
                <div class="classes-list-container" id="classes-list">
                    <!-- Classes will be loaded here -->
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤...</p>
                </div>
            </div>
        </div>

        <!-- Right Column -->
        <div class="right-column">
            <!-- My Assignments Card -->
            <div class="card">
                <div class="card-header">
                    <h2>üìö –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</h2>
                </div>

                <!-- Search and Filters -->
                <div class="search-filters">
                    <div class="form-group">
                        <input class="search-input"
                               type="text"
                               id="searchAssignments"
                               placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∑–∞–¥–∞–Ω–∏—è..."
                               onkeyup="searchTeacherAssignments()">
                    </div>
                    <div class="filter-row">
                        <div class="form-group">
                            <label for="classFilter">–§–∏–ª—å—Ç—Ä –ø–æ –∫–ª–∞—Å—Å—É:</label>
                            <select class="filter-case-option" id="classFilter" onchange="filterTeacherAssignments()">
                                <option value="">–í—Å–µ –∫–ª–∞—Å—Å—ã</option>
                            </select>
                        </div>
                        <button class="btn-action btn-secondary" onclick="clearFilters()">
                            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                        </button>
                    </div>
                </div>

                <!-- Assignments List -->
                <div id="assignments-list">
                    <div class="assignments-list">
                        <div class="no-assignments">
                            <i>üìã</i>
                            <h3>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...</h3>
                            <small>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</small>
                        </div>
                    </div>
                </div>

                <!-- Pagination -->
                <div id="pagination" class="pagination" style="display: none;">
                    <button id="prev-page" class="btn-action btn-secondary" onclick="changePage(-1)">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                    <span id="page-info" class="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                    <button id="next-page" class="btn-action btn-secondary" onclick="changePage(1)">
                        –í–ø–µ—Ä–µ–¥ ‚Üí
                    </button>
                </div>
            </div>

            <!-- Submissions to Grade Card -->
            <div class="card">
                <div class="card-header">
                    <h2>üìù –ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</h2>
                </div>
                <div id="submissions-to-grade">
                    <div class="submissions-list">
                        <div class="no-submissions">
                            <i>‚è≥</i>
                            <h3>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...</h3>
                            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Card -->
            <div class="card">
                <div class="card-header">
                    <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                </div>
                <div id="teacher-stats">
                    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                        <div class="stat-item">
                            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏–π</div>
                            <div class="stat-value" id="total-assignments">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</div>
                            <div class="stat-value" id="pending-submissions">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ</div>
                            <div class="stat-value" id="graded-submissions">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Section (at the bottom) -->
    <div class="statistics-section">
        <div class="card">
            <div class="card-header">
                <h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>
            </div>

            <div class="statistics-controls">
                <div class="form-group" style="flex: 1;">
                    <label for="class-select">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:</label>
                    <select id="class-select" class="form-select" onchange="statisticsManager.loadClassStatistics(this.value)">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å --</option>
                    </select>
                </div>

                <div class="statistics-actions">
                    <button class="btn-statistics btn-statistics-primary" onclick="statisticsManager.loadTeacherClasses()">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤
                    </button>
                    <button class="btn-statistics btn-statistics-secondary" onclick="statisticsManager.exportStatistics()">
                        üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                </div>
            </div>

            <div id="class-statistics" style="display: none;">
                <div class="class-summary" id="class-summary">
                    <!-- Class statistics will be here -->
                </div>

                <div class="students-statistics">
                    <h3 style="margin-bottom: 1rem;">üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h3>
                    <div class="students-table-container">
                        <div id="students-stats-table">
                            <!-- Students table will be here -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="no-statistics" class="no-statistics">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏</p>
            </div>
        </div>
    </div>
</div>

<!-- Modal Windows -->
<div id="createAssignmentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeCreateAssignmentModal()">&times;</span>

        <div class="modal-header">
            <h2><i>üìù</i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h2>
        </div>

        <div class="modal-body">
            <form id="createAssignmentForm" class="modal-form">
                <div class="form-group">
                    <label for="assignmentTitle" class="required">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
                    <input type="text"
                           id="assignmentTitle"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è"
                           required>
                    <div class="form-hint">–ë—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</div>
                </div>

                <div class="form-group">
                    <label for="assignmentDescription">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
                    <textarea id="assignmentDescription"
                              rows="4"
                              placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏..."></textarea>
                    <div class="form-hint">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="assignmentType" class="required">–¢–∏–ø –∑–∞–¥–∞–Ω–∏—è</label>
                        <select id="assignmentType" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                            <option value="homework">–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</option>
                            <option value="test">–¢–µ—Å—Ç</option>
                            <option value="quiz">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</option>
                            <option value="sor">–°–û–†</option>
                            <option value="soch">–°–û–ß</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="assignmentMaxGrade" class="required">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</label>
                        <div class="grade-input-container">
                            <input type="number"
                                   id="assignmentMaxGrade"
                                   value="100"
                                   min="1"
                                   max="1000"
                                   required>
                            <span class="grade-input-suffix">–±–∞–ª–ª–æ–≤</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="assignmentDeadline" class="required">–°—Ä–æ–∫ —Å–¥–∞—á–∏</label>
                    <input type="datetime-local" id="assignmentDeadline" required>
                    <div class="form-hint">–°—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ —Å–º–æ–≥—É—Ç —Å–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å—Ä–æ–∫–∞</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="assignmentClass" class="required">–ö–ª–∞—Å—Å</label>
                        <select id="assignmentClass" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</option>
                            <!-- –ö–ª–∞—Å—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="assignmentSubject" class="required">–ü—Ä–µ–¥–º–µ—Ç</label>
                        <select id="assignmentSubject" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                            <option value="1">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
                            <option value="2">–§–∏–∑–∏–∫–∞</option>
                            <option value="3">–•–∏–º–∏—è</option>
                            <option value="4">–ò—Å—Ç–æ—Ä–∏—è</option>
                            <option value="5">–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</option>
                            <option value="6">–ë–∏–æ–ª–æ–≥–∏—è</option>
                            <option value="7">–ì–µ–æ–≥—Ä–∞—Ñ–∏—è</option>
                            <option value="8">–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫</option>
                        </select>
                    </div>
                </div>

                <div class="form-info">
                    <p><strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–¥–∞–Ω–∏–∏.</p>
                </div>
            </form>
        </div>

        <div class="modal-footer">
            <button type="button"
                    class="btn-action btn-secondary"
                    onclick="closeCreateAssignmentModal()">
                –û—Ç–º–µ–Ω–∞
            </button>
            <button type="submit"
                    form="createAssignmentForm"
                    class="btn-action btn-primary">
                <i>‚úì</i> –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
            </button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ü–µ–Ω–∫–∏ –∑–∞–¥–∞–Ω–∏—è -->
<div id="gradeSubmissionModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeGradeSubmissionModal()">&times;</span>

        <div class="modal-header">
            <h2><i>üìä</i> –û—Ü–µ–Ω–∫–∞ –∑–∞–¥–∞–Ω–∏—è</h2>
        </div>

        <div class="modal-body">
            <div id="submission-details" class="submission-details-modal">
                <!-- –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>

            <form id="gradeSubmissionForm" class="modal-form">
                <input type="hidden" id="submissionId">

                <div class="form-group">
                    <label for="gradeValue" class="required">–û—Ü–µ–Ω–∫–∞</label>
                    <div class="grade-input-container">
                        <input type="number"
                               id="gradeValue"
                               min="0"
                               max="100"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ü–µ–Ω–∫—É"
                               required>
                        <span class="grade-input-suffix">/ <span id="max-grade">100</span></span>
                    </div>
                    <div class="form-hint">–û—Ü–µ–Ω–∫–∞ –æ—Ç 0 –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è</div>
                </div>

                <div class="form-group">
                    <label for="teacherComment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞</label>
                    <textarea id="teacherComment"
                              rows="4"
                              placeholder="–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –∑–∞–º–µ—á–∞–Ω–∏—è, –ø–æ—Ö–≤–∞–ª–∞..."></textarea>
                    <div class="form-hint">–ë—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ —Å—Ç—É–¥–µ–Ω—Ç—É –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                </div>

                <div class="form-warning">
                    <p><strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:</strong> –ü–æ—Å–ª–µ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—å –µ—ë –±—É–¥–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.</p>
                </div>
            </form>
        </div>

        <div class="modal-footer">
            <button type="button"
                    class="btn-action btn-secondary"
                    onclick="closeGradeSubmissionModal()">
                –û—Ç–º–µ–Ω–∞
            </button>
            <button type="submit"
                    form="gradeSubmissionForm"
                    class="btn-action btn-primary">
                <i>‚úì</i> –ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É
            </button>
        </div>
    </div>
</div>

<div id="fillSurveyModal" class="modal" style="display:none;">
    <div class="modal-content survey-modal">
        <span class="close" onclick="closeFillSurveyModal()">&times;</span>

        <div class="modal-header">
            <h2 id="fillSurveyTitle">–û–ø—Ä–æ—Å</h2>
        </div>

        <div class="modal-body">
            <form id="fillSurveyForm" class="modal-form">
                <p id="fillSurveyDescription" style="opacity:0.8;"></p>

                <div id="fillSurveyQuestions"></div>

                <div class="modal-footer">
                    <button type="submit" class="btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="/js/surveys-client.js"></script>
<script src="/js/api.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/teacher.js"></script>
<script src="/js/wikipedia.js"></script>
<script src="/js/notification.js"></script>
<script src="/js/statistics.js"></script>

<script>
    // Additional JavaScript for StatisticsManager
    if (typeof StatisticsManager !== 'undefined') {
        StatisticsManager.prototype.exportStatistics = function() {
            alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è!');
        };
    }
</script>
</body>
</html>