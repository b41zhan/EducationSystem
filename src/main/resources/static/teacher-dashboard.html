<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Education System - –£—á–∏—Ç–µ–ª—å</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ */
        .statistics-section {
            margin-top: 30px;
        }

        .statistics-controls {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .statistics-controls .form-group {
            flex: 1;
            min-width: 250px;
        }

        .class-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .class-summary h3 {
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 24px;
            text-align: center;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .summary-stat {
            text-align: center;
            padding: 20px 15px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 500;
        }

        .students-statistics {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .students-statistics h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #333;
            font-size: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .students-table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }

        .students-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 800px;
        }

        .students-table th {
            background: #f8f9fa;
            color: #333;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #667eea;
            position: sticky;
            top: 0;
            white-space: nowrap;
        }

        .students-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #e9ecef;
            transition: background-color 0.2s;
        }

        .students-table tr:hover {
            background: #f8f9fa;
        }

        .students-table tr:last-child td {
            border-bottom: none;
        }

        .student-name {
            font-weight: 600;
            min-width: 160px;
            color: #333;
        }

        .grade-cell {
            text-align: center;
            min-width: 60px;
            font-weight: 500;
            padding: 8px 5px;
        }

        .grade-excellent {
            background: #d4edda;
            color: #155724;
            font-weight: bold;
            border-radius: 4px;
        }
        .grade-good {
            background: #d1ecf1;
            color: #0c5460;
            border-radius: 4px;
        }
        .grade-average {
            background: #fff3cd;
            color: #856404;
            border-radius: 4px;
        }
        .grade-poor {
            background: #ffeaa7;
            color: #e17055;
            border-radius: 4px;
        }
        .grade-fail {
            background: #f8d7da;
            color: #721c24;
            font-weight: bold;
            border-radius: 4px;
        }
        .grade-missing {
            color: #6c757d;
            font-style: italic;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .average-grade {
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background: #e9ecef;
            border-radius: 6px;
            font-size: 16px;
        }

        .completion-cell {
            text-align: center;
            min-width: 100px;
        }

        .completion-rate {
            font-size: 12px;
            color: #6c757d;
            margin-top: 4px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: #28a745;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .no-statistics {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            font-style: italic;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px dashed #dee2e6;
        }

        .no-statistics p {
            font-size: 18px;
            margin: 0;
        }

        .statistics-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn-statistics {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-statistics-primary {
            background: #667eea;
            color: white;
        }

        .btn-statistics-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-statistics-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-statistics-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .statistics-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .statistics-controls .form-group {
                min-width: auto;
            }

            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-value {
                font-size: 24px;
            }

            .students-table-container {
                margin: 0 -10px;
                border-radius: 0;
                border-left: none;
                border-right: none;
            }
        }

        @media (max-width: 480px) {
            .summary-stats {
                grid-template-columns: 1fr;
            }

            .class-summary {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
<div class="dashboard">
    <div class="header">
        <!-- Wikipedia Search Widget -->
        <div class="wikipedia-widget">
            <div class="search-container">
                <input type="text"
                       id="wikipediaSearch"
                       placeholder="–ù–∞–π—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª –≤ Wikipedia..."
                       class="wikipedia-search-input">
                <div id="wikipediaResults" class="wikipedia-results"></div>
            </div>
        </div>
        <div class="user-info">
            <div>
                <h1>–ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</h1>
                <p id="welcome-message">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p>
            </div>
            <div>
                <span id="notification-badge" style="display: none; background: #dc3545; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; line-height: 20px; font-size: 12px; margin-right: 10px;"></span>
                <a href="/profile.html" class="btn-primary" style="margin-right: 10px;">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
                <button class="btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </div>

    <div class="content">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="left-column">
            <div class="card">
                <h2>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                <button class="btn-primary" onclick="showCreateAssignmentModal()">
                    –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                </button>
                <button class="btn-secondary" onclick="loadSubmissionsToGrade()">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
                </button>
                <div style="margin-top: 10px; font-size: 14px; color: #666;">
                    <span id="pending-count">0</span> –∑–∞–¥–∞–Ω–∏–π –∂–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
                </div>
            </div>

            <div class="card">
                <h2>–ú–æ–∏ –∫–ª–∞—Å—Å—ã</h2>
                <div id="classes-list">
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤...</p>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="right-column">
            <!-- –ë–ª–æ–∫ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ —Å –ø–æ–∏—Å–∫–æ–º –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π -->
            <div class="card">
                <h2>–ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</h2>

                <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
                <div class="search-filters">
                    <div class="form-group">
                        <input type="text" id="searchAssignments" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∑–∞–¥–∞–Ω–∏—è..."
                               onkeyup="searchTeacherAssignments()">
                    </div>
                    <div class="filter-row">
                        <div class="form-group">
                            <label for="classFilter">–§–∏–ª—å—Ç—Ä –ø–æ –∫–ª–∞—Å—Å—É:</label>
                            <select id="classFilter" onchange="filterTeacherAssignments()">
                                <option value="">–í—Å–µ –∫–ª–∞—Å—Å—ã</option>
                                <!-- –ö–ª–∞—Å—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </select>
                        </div>
                        <button class="btn-secondary" onclick="clearFilters()" style="margin-top: 25px;">
                            –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                        </button>
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π -->
                <div id="assignments-list">
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π...</p>
                </div>

                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                <div id="pagination" class="pagination" style="display: none;">
                    <button id="prev-page" class="btn-secondary" onclick="changePage(-1)">‚Üê –ù–∞–∑–∞–¥</button>
                    <span id="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                    <button id="next-page" class="btn-secondary" onclick="changePage(1)">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                </div>
            </div>

            <!-- –ë–ª–æ–∫ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É -->
            <div class="card">
                <h2>–ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</h2>
                <div id="submissions-to-grade">
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É...</p>
                </div>
            </div>

            <!-- –ë–ª–æ–∫ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π -->
            <div class="card">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div id="teacher-stats">
                    <p>–í—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏–π: <span id="total-assignments">0</span></p>
                    <p>–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ: <span id="pending-submissions">0</span></p>
                    <p>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: <span id="graded-submissions">0</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ - –ü–ï–†–ï–ú–ï–©–ï–ù–ê –í–ù–ò–ó -->
    <div class="statistics-section">
        <div class="card">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>

            <div class="statistics-controls">
                <div class="form-group">
                    <label for="class-select">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:</label>
                    <select id="class-select" onchange="statisticsManager.loadClassStatistics(this.value)">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å --</option>
                    </select>
                </div>

                <div class="statistics-actions">
                    <button class="btn-statistics btn-statistics-primary" onclick="statisticsManager.loadTeacherClasses()">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤
                    </button>
                    <button class="btn-statistics btn-statistics-secondary" onclick="statisticsManager.exportStatistics()">
                        üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                </div>
            </div>

            <div id="class-statistics" style="display: none;">
                <div class="class-summary" id="class-summary">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∞—Å—Å–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>

                <div class="students-statistics">
                    <h3>üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h3>
                    <div class="students-table-container">
                        <div id="students-stats-table">
                            <!-- –¢–∞–±–ª–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="no-statistics" class="no-statistics">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏</p>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è -->
<div id="createAssignmentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeCreateAssignmentModal()">&times;</span>
        <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h2>
        <form id="createAssignmentForm">
            <div class="form-group">
                <label for="assignmentTitle">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="assignmentTitle" required>
            </div>
            <div class="form-group">
                <label for="assignmentDescription">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                <textarea id="assignmentDescription" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="assignmentType">–¢–∏–ø:</label>
                <select id="assignmentType" required>
                    <option value="homework">–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</option>
                    <option value="test">–¢–µ—Å—Ç</option>
                    <option value="quiz">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</option>
                    <option value="sor">–°–û–†</option>
                    <option value="soch">–°–û–ß</option>
                </select>
            </div>
            <div class="form-group">
                <label for="assignmentMaxGrade">–ú–∞–∫—Å. –æ—Ü–µ–Ω–∫–∞:</label>
                <input type="number" id="assignmentMaxGrade" value="100" min="1" max="100">
            </div>
            <div class="form-group">
                <label for="assignmentDeadline">–°—Ä–æ–∫ —Å–¥–∞—á–∏:</label>
                <input type="datetime-local" id="assignmentDeadline" required>
            </div>
            <div class="form-group">
                <label for="assignmentClass">–ö–ª–∞—Å—Å:</label>
                <select id="assignmentClass" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</option>
                </select>
            </div>
            <div class="form-group">
                <label for="assignmentSubject">–ü—Ä–µ–¥–º–µ—Ç:</label>
                <select id="assignmentSubject" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                    <option value="1">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
                    <option value="2">–§–∏–∑–∏–∫–∞</option>
                    <option value="3">–•–∏–º–∏—è</option>
                    <option value="4">–ò—Å—Ç–æ—Ä–∏—è</option>
                    <option value="5">–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</option>
                </select>
            </div>
            <button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ü–µ–Ω–∫–∏ –∑–∞–¥–∞–Ω–∏—è -->
<div id="gradeSubmissionModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeGradeSubmissionModal()">&times;</span>
        <h2>–û—Ü–µ–Ω–∫–∞ –∑–∞–¥–∞–Ω–∏—è</h2>
        <div id="submission-details">
            <!-- –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
        <form id="gradeSubmissionForm">
            <input type="hidden" id="submissionId">
            <div class="form-group">
                <label for="gradeValue">–û—Ü–µ–Ω–∫–∞:</label>
                <input type="number" id="gradeValue" min="0" max="100" required>
                <small>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞: <span id="max-grade">100</span></small>
            </div>
            <div class="form-group">
                <label for="teacherComment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                <textarea id="teacherComment" rows="4" placeholder="–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞..."></textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">–ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</button>
                <button type="button" class="btn-secondary" onclick="closeGradeSubmissionModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </form>
    </div>
</div>

<script src="/js/api.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/teacher.js"></script>
<script src="/js/wikipedia.js"></script>
<script src="/js/notification.js"></script>
<script src="/js/statistics.js"></script>

<script>
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è StatisticsManager
    if (typeof StatisticsManager !== 'undefined') {
        StatisticsManager.prototype.exportStatistics = function() {
            alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è!');
        };
    }
</script>
</body>
</html>