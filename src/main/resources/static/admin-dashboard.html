<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Education System - Администратор</title>
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="dashboard">
    <!-- Верхняя панель -->
    <header class="top-bar">
        <div class="brand">
            <h1><i class="fas fa-user-shield"></i> Панель администратора</h1>
            <p class="welcome-message" id="welcome-message">Добро пожаловать!</p>
        </div>
        <button class="btn-logout" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Выйти
        </button>
    </header>

    <div class="container">
        <!-- Левая колонка - Основные действия -->
        <aside class="sidebar">
            <div class="card">
                <h2 class="card-header">
                    <i class="fas fa-users-cog"></i> Управление пользователями
                </h2>
                <div class="action-buttons">
                    <button class="btn-action btn-primary" onclick="showRegisterTeacherModal()">
                        <i class="fas fa-chalkboard-teacher"></i> Новый учитель
                    </button>
                    <button class="btn-action btn-primary" onclick="showRegisterStudentModal()">
                        <i class="fas fa-user-graduate"></i> Новый студент
                    </button>
                    <button class="btn-action btn-primary" onclick="showRegisterParentModal()">
                        <i class="fas fa-user-friends"></i> Новый родитель
                    </button>
                </div>
            </div>

            <div class="card clickable" onclick="location.href='/admin-schedule.html'">
                <div class="card-icon"><i class="fas fa-calendar-alt"></i></div>
                <div class="card-content">
                    <h3>Управление расписанием</h3>
                    <p>Создание и редактирование расписания</p>
                </div>
                <i class="fas fa-chevron-right card-arrow"></i>
            </div>

            <div class="card stats-card">
                <h2 class="card-header">
                    <i class="fas fa-chart-bar"></i> Статистика системы
                </h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">Всего пользователей</div>
                        <div class="stat-value" id="total-users">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Учителей</div>
                        <div class="stat-value" id="total-teachers">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Студентов</div>
                        <div class="stat-value" id="total-students">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Родителей</div>
                        <div class="stat-value" id="total-parents">0</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Основной контент -->
        <main class="main-content">
            <div class="content-header">
                <h2><i class="fas fa-list"></i> Список пользователей</h2>
                <div class="search-box">
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-users" placeholder="Поиск по email или имени..." onkeypress="if(event.key === 'Enter') searchUsers()">
                    </div>
                    <button class="btn-search" onclick="searchUsers()">Найти</button>
                </div>
            </div>

            <div class="card users-card">
                <div class="table-header">
                    <div class="header-cell">Пользователь</div>
                    <div class="header-cell">Email</div>
                    <div class="header-cell">Роль</div>
                    <div class="header-cell">Дата регистрации</div>
                    <div class="header-cell">Действия</div>
                </div>
                <div class="users-list" id="users-list">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Загрузка пользователей...</p>
                    </div>
                </div>
                <div class="table-footer">
                    <div class="pagination">
                        <button class="pagination-btn" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="page-info">Страница 1 из 1</span>
                        <button class="pagination-btn" disabled>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="users-count">
                        Всего: <span id="users-total-count">0</span> пользователей
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<!-- Модальное окно регистрации учителя -->
<div id="registerTeacherModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterTeacherModal()">&times;</span>
        <h2><i class="fas fa-chalkboard-teacher"></i> Регистрация учителя</h2>
        <form id="registerTeacherForm">
            <div class="form-group">
                <label for="teacherEmail">Email:</label>
                <input type="email" id="teacherEmail" required placeholder="teacher@school.edu">
            </div>
            <div class="form-group">
                <label for="teacherPassword">Пароль:</label>
                <input type="password" id="teacherPassword" required placeholder="Минимум 8 символов">
                <div class="form-hint">Минимум 8 символов</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="teacherLastName">Фамилия:</label>
                    <input type="text" id="teacherLastName" required placeholder="Ерболовна">
                </div>
                <div class="form-group">
                    <label for="teacherFirstName">Имя:</label>
                    <input type="text" id="teacherFirstName" required placeholder="Айгуль">
                </div>
            </div>
            <div class="form-group">
                <label for="teacherPatronymic">Отчество:</label>
                <input type="text" id="teacherPatronymic" placeholder="Ерланкызы">
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> Зарегистрировать
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterTeacherModal()">
                    Отмена
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Модальное окно регистрации студента -->
<div id="registerStudentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterStudentModal()">&times;</span>
        <h2><i class="fas fa-user-graduate"></i> Регистрация студента</h2>
        <form id="registerStudentForm">
            <div class="form-group">
                <label for="studentEmail">Email:</label>
                <input type="email" id="studentEmail" required placeholder="student@school.edu">
            </div>
            <div class="form-group">
                <label for="studentPassword">Пароль:</label>
                <input type="password" id="studentPassword" required placeholder="Минимум 8 символов">
                <div class="form-hint">Минимум 8 символов</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="studentLastName">Фамилия:</label>
                    <input type="text" id="studentLastName" required placeholder="Сатпаев">
                </div>
                <div class="form-group">
                    <label for="studentFirstName">Имя:</label>
                    <input type="text" id="studentFirstName" required placeholder="Дастан">
                </div>
            </div>
            <div class="form-group">
                <label for="studentPatronymic">Отчество:</label>
                <input type="text" id="studentPatronymic" placeholder="Сатпаевич">
            </div>
            <div class="form-group">
                <label for="studentClass">Класс:</label>
                <select id="studentClass" required>
                    <option value="">Выберите класс</option>
                    <option value="8А">8А</option>
                    <option value="8Б">8Б</option>
                    <option value="8В">8В</option>
                    <option value="9А">9А</option>
                    <option value="9Б">9Б</option>
                    <option value="9В">9В</option>
                    <option value="10А">10А</option>
                    <option value="10Б">10Б</option>
                    <option value="10В">10В</option>
                    <option value="11А">11А</option>
                    <option value="11Б">11Б</option>
                    <option value="11В">11В</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> Зарегистрировать
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterStudentModal()">
                    Отмена
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Модальное окно регистрации родителя -->
<div id="registerParentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterParentModal()">&times;</span>
        <h2><i class="fas fa-user-friends"></i> Регистрация родителя</h2>
        <form id="registerParentForm">
            <div class="form-group">
                <label for="parentEmail">Email:</label>
                <input type="email" id="parentEmail" required placeholder="parent@email.com">
            </div>
            <div class="form-group">
                <label for="parentPassword">Пароль:</label>
                <input type="password" id="parentPassword" required placeholder="Минимум 8 символов">
                <div class="form-hint">Минимум 8 символов</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="parentLastName">Фамилия:</label>
                    <input type="text" id="parentLastName" required placeholder="Сидорова">
                </div>
                <div class="form-group">
                    <label for="parentFirstName">Имя:</label>
                    <input type="text" id="parentFirstName" required placeholder="Мария">
                </div>
            </div>
            <div class="form-group">
                <label for="parentPatronymic">Отчество:</label>
                <input type="text" id="parentPatronymic" placeholder="Ивановна">
            </div>
            <div class="form-group">
                <label for="parentStudent">Привязать к студенту:</label>
                <select id="parentStudent">
                    <option value="">Не привязывать</option>
                    <!-- Будет заполняться динамически -->
                </select>
                <div class="form-hint">Опционально, можно добавить позже</div>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> Зарегистрировать
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterParentModal()">
                    Отмена
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Модальное окно редактирования пользователя -->
<div id="editUserModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeEditUserModal()">&times;</span>
        <h2><i class="fas fa-edit"></i> Редактирование пользователя</h2>
        <form id="editUserForm">
            <input type="hidden" id="editUserId">

            <div class="form-group">
                <label for="editEmail">Email:</label>
                <input type="email" id="editEmail" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="editLastName">Фамилия:</label>
                    <input type="text" id="editLastName" required>
                </div>
                <div class="form-group">
                    <label for="editFirstName">Имя:</label>
                    <input type="text" id="editFirstName" required>
                </div>
            </div>

            <div class="form-group">
                <label for="editPatronymic">Отчество:</label>
                <input type="text" id="editPatronymic">
            </div>

            <div class="form-group">
                <label for="editPassword">Новый пароль:</label>
                <input type="password" id="editPassword" placeholder="Оставьте пустым, чтобы не менять">
                <div class="form-hint">Только если нужно изменить пароль</div>
            </div>

            <div class="form-group">
                <label for="editRole">Роль:</label>
                <select id="editRole" required>
                    <option value="student">Студент</option>
                    <option value="teacher">Учитель</option>
                    <option value="parent">Родитель</option>
                </select>
            </div>

            <div class="activity-section">
                <h3><i class="fas fa-history"></i> Активность пользователя</h3>
                <div id="editUserHistory" class="edit-user-history">
                    <div class="activity-item">
                        <div class="activity-icon"><i class="fas fa-sign-in-alt"></i></div>
                        <div class="activity-content">
                            <div class="activity-title">Последний вход</div>
                            <div class="activity-time">12.01.2024 14:30</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-save"></i> Сохранить
                </button>
                <button type="button" class="btn-secondary" onclick="closeEditUserModal()">
                    Отмена
                </button>
                <button type="button" class="btn-danger" id="deleteUserBtn" onclick="deleteUser()" style="display: none;">
                    <i class="fas fa-trash"></i> Удалить пользователя
                </button>
            </div>
        </form>
    </div>
</div>

<script src="/js/api.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/admin.js"></script>
</body>
</html>