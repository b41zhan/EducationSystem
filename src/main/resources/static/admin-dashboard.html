<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Education System - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</title>
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="dashboard">
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <header class="top-bar">
        <div class="brand">
            <h1><i class="fas fa-user-shield"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
            <p class="welcome-message" id="welcome-message">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p>
        </div>
        <button class="btn-logout" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
        </button>
    </header>

    <div class="container">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <aside class="sidebar">
            <div class="card">
                <h2 class="card-header">
                    <i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
                </h2>
                <div class="action-buttons">
                    <button class="btn-action btn-primary" onclick="showRegisterTeacherModal()">
                        <i class="fas fa-chalkboard-teacher"></i> –ù–æ–≤—ã–π —É—á–∏—Ç–µ–ª—å
                    </button>
                    <button class="btn-action btn-primary" onclick="showRegisterStudentModal()">
                        <i class="fas fa-user-graduate"></i> –ù–æ–≤—ã–π —Å—Ç—É–¥–µ–Ω—Ç
                    </button>
                    <button class="btn-action btn-primary" onclick="showRegisterParentModal()">
                        <i class="fas fa-user-friends"></i> –ù–æ–≤—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å
                    </button>
                </div>
            </div>

            <div class="card clickable" onclick="location.href='/admin-schedule.html'">
                <div class="card-icon"><i class="fas fa-calendar-alt"></i></div>
                <div class="card-content">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º</h3>
                    <p>–°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</p>
                </div>
                <i class="fas fa-chevron-right card-arrow"></i>
            </div>

            <div class="card clickable" onclick="openSurveyModal()">
                <div class="card-icon"><i class="fas fa-poll"></i></div>
                <div class="card-content">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–æ—Å</h3>
                    <p>–°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π</p>
                </div>
                <i class="fas fa-chevron-right card-arrow"></i>
            </div>


            <div class="card stats-card">
                <h2 class="card-header">
                    <i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
                </h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="stat-value" id="total-users">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">–£—á–∏—Ç–µ–ª–µ–π</div>
                        <div class="stat-value" id="total-teachers">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">–°—Ç—É–¥–µ–Ω—Ç–æ–≤</div>
                        <div class="stat-value" id="total-students">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">–†–æ–¥–∏—Ç–µ–ª–µ–π</div>
                        <div class="stat-value" id="total-parents">0</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <div class="content-header">
                <h2><i class="fas fa-list"></i> –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                <div class="search-box">
                    <div class="search-input">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-users" placeholder="–ü–æ–∏—Å–∫ –ø–æ email –∏–ª–∏ –∏–º–µ–Ω–∏..." onkeypress="if(event.key === 'Enter') searchUsers()">
                    </div>
                    <button class="btn-search" onclick="searchUsers()">–ù–∞–π—Ç–∏</button>
                </div>
            </div>

            <div class="card users-card">
                <div class="table-header">
                    <div class="header-cell">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                    <div class="header-cell">Email</div>
                    <div class="header-cell">–†–æ–ª—å</div>
                    <div class="header-cell">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                    <div class="header-cell">–î–µ–π—Å—Ç–≤–∏—è</div>
                </div>
                <div class="users-list" id="users-list">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</p>
                    </div>
                </div>
                <div class="table-footer">
                    <div class="pagination">
                        <button class="pagination-btn" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                        <button class="pagination-btn" disabled>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="users-count">
                        –í—Å–µ–≥–æ: <span id="users-total-count">0</span> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–∏—Ç–µ–ª—è -->
<div id="registerTeacherModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterTeacherModal()">&times;</span>
        <h2><i class="fas fa-chalkboard-teacher"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–∏—Ç–µ–ª—è</h2>
        <form id="registerTeacherForm">
            <div class="form-group">
                <label for="teacherSchoolSelect">–®–∫–æ–ª–∞:</label>
                <select id="teacherSchoolSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —à–∫–æ–ª—É</option>
                </select>
            </div>
            <div class="form-group">
                <label for="teacherEmail">Email:</label>
                <input type="email" id="teacherEmail" required placeholder="teacher@school.edu">
            </div>
            <div class="form-group">
                <label for="teacherPassword">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="teacherPassword" required placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤">
                <div class="form-hint">–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="teacherLastName">–§–∞–º–∏–ª–∏—è:</label>
                    <input type="text" id="teacherLastName" required placeholder="–ï—Ä–±–æ–ª–æ–≤–Ω–∞">
                </div>
                <div class="form-group">
                    <label for="teacherFirstName">–ò–º—è:</label>
                    <input type="text" id="teacherFirstName" required placeholder="–ê–π–≥—É–ª—å">
                </div>
            </div>
            <div class="form-group">
                <label for="teacherPatronymic">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                <input type="text" id="teacherPatronymic" placeholder="–ï—Ä–ª–∞–Ω–∫—ã–∑—ã">
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterTeacherModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ -->
<div id="registerStudentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterStudentModal()">&times;</span>
        <h2><i class="fas fa-user-graduate"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞</h2>
        <form id="registerStudentForm">
            <div class="form-group">
                <label for="studentSchoolSelect">–®–∫–æ–ª–∞:</label>
                <select id="studentSchoolSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —à–∫–æ–ª—É</option>
                </select>
            </div>
            <div class="form-group">
                <label for="studentClassSelect">–ö–ª–∞—Å—Å:</label>
                <select id="studentClassSelect" required>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —à–∫–æ–ª—É</option>
                </select>
            </div>
            <div class="form-group">
                <label for="studentEmail">Email:</label>
                <input type="email" id="studentEmail" required placeholder="student@school.edu">
            </div>
            <div class="form-group">
                <label for="studentPassword">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="studentPassword" required placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤">
                <div class="form-hint">–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="studentLastName">–§–∞–º–∏–ª–∏—è:</label>
                    <input type="text" id="studentLastName" required placeholder="–°–∞—Ç–ø–∞–µ–≤">
                </div>
                <div class="form-group">
                    <label for="studentFirstName">–ò–º—è:</label>
                    <input type="text" id="studentFirstName" required placeholder="–î–∞—Å—Ç–∞–Ω">
                </div>
            </div>
            <div class="form-group">
                <label for="studentPatronymic">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                <input type="text" id="studentPatronymic" placeholder="–°–∞—Ç–ø–∞–µ–≤–∏—á">
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterStudentModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—è -->
<div id="registerParentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeRegisterParentModal()">&times;</span>
        <h2><i class="fas fa-user-friends"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è</h2>
        <form id="registerParentForm">
            <div class="form-group">
                <label for="parentSchoolSelect">–®–∫–æ–ª–∞:</label>
                <select id="parentSchoolSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —à–∫–æ–ª—É</option>
                </select>
            </div>

            <div class="form-group">
                <label for="parentClassSelect">–ö–ª–∞—Å—Å:</label>
                <select id="parentClassSelect" required>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —à–∫–æ–ª—É</option>
                </select>
            </div>

            <div class="form-group">
                <label for="parentStudentsSelect">–î–µ—Ç–∏ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ):</label>
                <select id="parentStudentsSelect" multiple required>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</option>
                </select>
                <div class="form-hint">–ó–∞–∂–º–∏—Ç–µ Ctrl (Windows) / Cmd (Mac), —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ</div>
            </div>

            <div class="form-group">
                <label for="parentEmail">Email:</label>
                <input type="email" id="parentEmail" required placeholder="parent@email.com">
            </div>
            <div class="form-group">
                <label for="parentPassword">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="parentPassword" required placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤">
                <div class="form-hint">–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="parentLastName">–§–∞–º–∏–ª–∏—è:</label>
                    <input type="text" id="parentLastName" required placeholder="–°–∏–¥–æ—Ä–æ–≤–∞">
                </div>
                <div class="form-group">
                    <label for="parentFirstName">–ò–º—è:</label>
                    <input type="text" id="parentFirstName" required placeholder="–ú–∞—Ä–∏—è">
                </div>
            </div>
            <div class="form-group">
                <label for="parentPatronymic">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                <input type="text" id="parentPatronymic" placeholder="–ò–≤–∞–Ω–æ–≤–Ω–∞">
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button type="button" class="btn-secondary" onclick="closeRegisterParentModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div id="editUserModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeEditUserModal()">&times;</span>
        <h2><i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
        <form id="editUserForm">
            <input type="hidden" id="editUserId">

            <div class="form-group">
                <label for="editEmail">Email:</label>
                <input type="email" id="editEmail" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="editLastName">–§–∞–º–∏–ª–∏—è:</label>
                    <input type="text" id="editLastName" required>
                </div>
                <div class="form-group">
                    <label for="editFirstName">–ò–º—è:</label>
                    <input type="text" id="editFirstName" required>
                </div>
            </div>

            <div class="form-group">
                <label for="editPatronymic">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                <input type="text" id="editPatronymic">
            </div>

            <div class="form-group">
                <label for="editPassword">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="editPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å">
                <div class="form-hint">–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</div>
            </div>

            <div class="form-group">
                <label for="editRole">–†–æ–ª—å:</label>
                <select id="editRole" required>
                    <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
                    <option value="teacher">–£—á–∏—Ç–µ–ª—å</option>
                    <option value="parent">–†–æ–¥–∏—Ç–µ–ª—å</option>
                </select>
            </div>

            <div class="activity-section">
                <h3><i class="fas fa-history"></i> –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <div id="editUserHistory" class="edit-user-history">
                    <div class="activity-item">
                        <div class="activity-icon"><i class="fas fa-sign-in-alt"></i></div>
                        <div class="activity-content">
                            <div class="activity-title">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</div>
                            <div class="activity-time">12.01.2024 14:30</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button type="button" class="btn-secondary" onclick="closeEditUserModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="button" class="btn-danger" id="deleteUserBtn" onclick="deleteUser()" style="display: none;">
                    <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Survey Modal -->
<div id="surveyModal" class="modal" style="display:none;">
    <div class="modal-content survey-modal">
        <span class="close" onclick="closeSurveyModal()">&times;</span>

        <div class="modal-header">
            <h2>üó≥ –°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å</h2>
        </div>

        <div class="modal-body">
            <form id="surveyForm" class="modal-form">
                <div class="form-group">
                    <label class="required">–ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞</label>
                    <input type="text" id="surveyTitle" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —É—Ä–æ–∫–æ–≤">
                </div>

                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="description" id="surveyDescription" rows="2"
                              placeholder="–ö—Ä–∞—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –æ —á–µ–º —ç—Ç–æ—Ç –æ–ø—Ä–æ—Å"></textarea>
                </div>

                <div class="form-group">
                    <label>–ö–æ–º—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å</label>
                    <div class="survey-targets">
                        <label><input type="checkbox" id="surveyForStudents" checked> –°—Ç—É–¥–µ–Ω—Ç—ã</label>
                        <label><input type="checkbox" id="surveyForTeachers"> –£—á–∏—Ç–µ–ª—è</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="required">–í–æ–ø—Ä–æ—Å—ã</label>
                    <div id="surveyQuestionsContainer"></div>
                    <button type="button" class="btn-submit2" onclick="addSurveyQuestion()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
                    </button>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn-submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ä–æ—Å</button>
                </div>
            </form>

            <hr style="margin: 1.5rem 0;">

            <div class="survey-results-panel">
                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–æ–≤</h3>

                <div class="form-group">
                    <label for="surveyResultsSelect">–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ä–æ—Å</label>
                    <select id="surveyResultsSelect"></select>
                </div>

                <button type="button" class="btn-submit2" onclick="loadSurveyResults()">
                    –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                </button>

                <div id="surveyResultsContainer" style="margin-top: 1rem;"></div>

                <canvas id="surveyChart" style="margin-top: 1rem; max-height: 260px;"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/js/admin-surveys.js"></script>
<script src="/js/api.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/admin.js"></script>
</body>
</html>